function updatePossibleMoves() {
    let count = 0;
    for (let c = 0; c < columns.length; c++) {
        const col = columns[c];
        for (let r = 0; r < col.length; r++) {
            const card = col[r];
            if (!card.faceUp) continue;

            // √Ñl√§ laske siirtoa, jos kortti on jo oikean kortin p√§√§ll√§
            if (r > 0 && col[r-1].rank === card.rank + 1 && col[r-1].suit === card.suit) continue;

            for (let t = 0; t < columns.length; t++) {
                if (c === t) continue;
                const target = columns[t];
                
                if (target.length === 0) {
                    // √ÑLYK√ÑS KUNINGASS√Ñ√ÑNT√ñ:
                    // Laske Kuninkaan siirto vain, jos se vapauttaa jotain (eli ei ole jo sarakkeen k√§rjess√§)
                    if (card.rank === 13 && r !== 0) {
                        count++;
                    }
                } else {
                    // Kohdekortin on oltava vapaana (viimeinen)
                    const last = target[target.length - 1];
                    if (last.rank === card.rank + 1 && last.suit === card.suit) {
                        count++;
                    }
                }
            }
        }
    }
    
    const moveDisplay = document.getElementById("moveCount");
    const infoBox = document.getElementById("info");
    
    moveDisplay.innerText = count;

    if (count === 0 && stock.length === 0) {
        infoBox.innerHTML = "üö® <strong>PELI JUMISSA!</strong> Ei en√§√§ hy√∂dyllisi√§ siirtoja.";
        infoBox.style.color = "#ff6b6b";
    } else {
        infoBox.style.color = "white";
    }
}
